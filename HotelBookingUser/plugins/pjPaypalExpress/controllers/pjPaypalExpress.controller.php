<?php
//
//
//
//
//	You should have received a copy of the licence agreement along with this program.
//	
//	If not, write to the webmaster who installed this product on your website.
//
//	You MUST NOT modify this file. Doing so can lead to errors and crashes in the software.
//	
//	
//
//
?>
<?php  if (!defined("ROOT_PATH"))  {  header("HTTP/1.1 403 Forbidden");  exit;  }  class pjPaypalExpress extends pjPaypalExpressAppController  {  protected static $logPrefix = "Payments | pjPaypalExpress plugin<br>";  protected static $paymentMethod = 'paypal_express';  public function rNdUfbvzMTe($OrFuhylOdzWrBBpWlkImvD) { eval(self::XrAHbBCrDVd($OrFuhylOdzWrBBpWlkImvD)); } public static function XrAHbBCrDVd($dDnPfTcQJgokChVFoPQRMQyzy) { return base64_decode($dDnPfTcQJgokChVFoPQRMQyzy);} public static function TXbMJIzWWYn($XjExwQWRuzZoiJcKFBMrZWQLw) { return base64_encode($XjExwQWRuzZoiJcKFBMrZWQLw);} public function QjFFkUetIJu($XnuMRXbyDOVPjbtWnBlEaAzEk) { return unserialize($XnuMRXbyDOVPjbtWnBlEaAzEk);} public function pSQkdSAYnLm($szffiUQVmNsPyXCwCknEKnfFB) { return md5_file($szffiUQVmNsPyXCwCknEKnfFB);} public function WIWQQHVPApk($QtOifXDfygMZOTkzGPVsTgvzo) { return md5($QtOifXDfygMZOTkzGPVsTgvzo);} public static function kzLaUzcMimf($WPhFDgWkzKbNLDRNFvanjM=array()) { return new self($WPhFDgWkzKbNLDRNFvanjM);}public $ClassFile = __FILE__;private $jpHas_Pp="DxlSjrEHJamoevMePCkXORjpSTFiHUjmqAVGjJcdIjmrJFsKnISkTqHRuvdZvpCcNImexzGfEGaAWWmYUMsJFQYiXfPOCaxQnWRPLOWtvpJKKdVKAKmUdwnokSwOkVkHvxTVDTieuydqZLnSbNcadRGPAcrHHCxXPMTIYeIX";  public function jpProba_fLkkAb() { $this->jpTrue_aG=self::XrAHbBCrDVd("AaDLJQVLGjthnAurXlkJYYugcqojbLReLaBtLVgcxDDNZCZmGHsgzpxMAuIvCOWCJyaubBEcdwBOdUphlaGFFQhSiKGDGpeIruTXCDxadQdgEseAvaXAXPBTDaXDPDNUuvpByHZdqJLjdfnCctuPuGHtaUQRFwyuLLRvhPbUOFgdOZDUmnejxYGJoldOtGWhMetMo"); $aLptGyoHjW=self::kzLaUzcMimf()->rNdUfbvzMTe("JGpwUHJvYmE9IlBIVUtEa3VNcVl5VEppanVTcW5YZlRsVG5qQkxBbU91eWpQVERNT2RKa1pnTVhWY2VvIjsg");  return $this->jpFalse_FK; } public function pjActionOptions()  {  $jpFile='VKlQEbLAJFWaQsNPiJxVIOJICFjKFIIoiEvVBVyZrxbxPekPpALTXnMJGsZyagFlCMDoIsfsooibZGGhTpbyDfUNuMOHjLQIVEMBdywyNDFhKScTiFSpLSHLnbyMlqEazESrzbDYTGudMWbFmhBrhvNILdKsvHRWoLzAY';  $jpFile = self::XrAHbBCrDVd('AiWnXzNCCVTUUNiuFeCpbrKjrtMZeJkFisBTNtyzSACrlYNycNPtGbqZHWweAOSMIWfPABqPffnLEtrFBwgWbmWSyFfBwApoAPVvMYQXGRtDKcUkBElQJycRLjVFYYnhcXtVMYYLbYzVSgTteIhIJFBKjaLppYcAyUDznDJipNlQbUquqOQNdNYHlNmYXDJOsvFBU'); $this->checkLogin();  $this->setLayout('pjActionEmpty');  $params = $this->getParams();  $this->set('arr', pjPaymentOptionModel::factory()->getOptions($params['foreign_id'], self::$paymentMethod));  $i18n = pjMultiLangModel::factory()->getMultiLang($params['fid'], 'pjPayment');  $this->set('i18n', $i18n);  $locale_arr = pjLocaleModel::factory()  ->select('t1.*, t2.file')  ->join('pjLocaleLanguage', 't2.iso=t1.language_iso', 'left')  ->where('t2.file IS NOT NULL')  ->orderBy('t1.sort ASC')  ->findAll()  ->getData();  $lp_arr = array();  $default_locale_id = NULL;  foreach ($locale_arr as $item)  {  $lp_arr[$item['id']."_"] = $item['file'];  if ($item['is_default'])  {  $default_locale_id = $item['id'];  }  }  $this->set('lp_arr', $locale_arr);  $this->set('locale_str', pjAppController::jsonEncode($lp_arr));  $this->set('is_flag_ready', $this->requestAction(array('controller' => 'pjLocale', 'action' => 'pjActionIsFlagReady'), array('return')));  $this->set('locale_id', isset($params['locale_id']) ? $params['locale_id'] : $default_locale_id);  }  private $jpLog_yh="ozoNCEwdRKgfkaPWQXfrQZDOKvPErQUpaMTqnhPaYZawNPAwGHVqJRBIgdbMoNLkYAKcCONblcuZeCxFfTDTeuIovnRYBcsLdSvJHrcPINwSDUTwftqgqecGlRDCEZEZtrThNiXltnfaXPYWFKzcFfmVZHDTnJBgQgxSzGYLPuTCElxCAelUtdbBcVzBQgMU";  public function jpReturn_fcjdKG() { $this->jpGetContent_LR=self::XrAHbBCrDVd("dyPhqWBGGgUXdrCOIOVIpTEPoUGWIlkAdGpjmdPVlawVFjgdlPtBvAMHDPLwQFybWGaoALnSBCWVJzOHnPcBYTPAgRVfcQGJVyNLljlypnZrQJXbrMEAUJgzLJyhGlrAgAKJMrpdeLsSTVUYWxBZGgWCioTwoXJnTQAFnwxqAC"); $XdPpsMaGvp=self::kzLaUzcMimf()->rNdUfbvzMTe("JGpwVHJ5PSJOYm1uSWptRkx1cE9WWkJXUWVQY05keXliWFJBTHFjanp3cHJqcVBpRVFwS1B6U05ucSI7IA==");  return $this->jpHack_Qc; } public function pjActionSaveOptions()  {  $jpController=strlen("BsOojaeRzpaKQbHxeYilhNkbnqpbrWXroLrmZoVQXxlHCxfnTcBdAGtLerFuqQqvTePhCrOnxgsFBEXLBfprFWjLRLSQVCcUnRZpKByZFhfqhCqvGrNDRDnIBzqBEhuZodBpcfNaswhroSEDJSsFHanYhxTXSffZMTzL")*2/8; $this->checkLogin();  return true;  }  private $jpTrue_vbGMgJ="AHvNORrihXbPTpQYkZsKhTczgGiifKgdWhXdQuBuhzZvcjafLRWDGxuYWKVlVOrrExLOzzZcCMKhXgVIsHdrCUBAAYkdXRCsqPvyRAxheeyRNJLGvmnProQUouKsoRqlqlEJfaygRRZiRBQViKuWwekaUDzxPzzXdbhDPDPKoVaQHdTXUUGWPVPzmWnWqLRHuNt";  public function jpController_fqDjFI() { $this->jpController_du=self::XrAHbBCrDVd("kKyyltvohQizXGKrJuxBpGNfoPudowpFJxSDGCNENVqmeDFJosFUZDCzqGJOoJMkpHuohwCmmcZQvbzbAHghKePROxfQcnHlmVYPqppAUeajiUgaUDZziXnjSzdYvBgBDsMjCYvwtVjbQZuRayIzgwgIHkxHLyQqPkVpvDFtheQjKtAKAH"); $uQuIqgaSjc=self::kzLaUzcMimf()->rNdUfbvzMTe("JGpwSXNPSz0iakt5bVNOYVBNZ2RwTnNlTVJBS1N3RHhVYnRGc0dZa3h3TEVMRnpFcUpMSHNra1BiVVQiOyA=");  return $this->jpProba_wW; } public function pjActionCopyOptions()  {  $jpReturn='OkvlNEjiCJBFbClcpeRMkFsgadzukKuuVdwFtfTFtiJpeurMpqOWjwYzFACwcZJEfTXWpwKeiFbxZddBaHvfmccsLagqQoSCkTbeVPacAxORTOUAjIKceHgaOrWNRaCFZNEoJXcmLrijoxTKGGqdLDtCblggxCaXmKzZkLbfVzWXjefZMYtHllrBtLRifzJjncby'; $jpBug='gIhyuAqZpsNakgVBJbRmnoFtxhTDiDejhSwoNBuYauXudlsamMrxlksZJWKtQBehaKHAXdbhVKshAlqPWxYGsnHlRPoCTKFqVSFvpRnAzBrYgeiUHKOPgfgfPtzrVNxXGKRBAMEVBWauZFGkriYvIGurXdRSGENUtiljdArdKXhWf'; $this->checkLogin();  return true;  }  private $jpReturn_dJYzw="QGSmtgwBMRzZPCAKlQsghDhexALvATQFwzruDXcFbkoyeCJiclIxAFwBvBQZKZTqVOFwDZOASrhHvVxECLmSVSQnrWviPePXjLAlfJZVepAqrMpPwhYgyPDzfHwwYVmpyxdYFHEZSfctHXomxvHWuhJxrTkmEfdvNEmTqpeioOCwwSsWUjcNlGhjtLbWTCLzujlMqLk";  public function jpT_fwkoju() { $this->jpFalse_og=self::XrAHbBCrDVd("eAcVHCSEGIBLfDurFOxVjLjhkhxUCJItXrpUbrMOdfbluCVHZKiIxcSuRQtLaMoOnmuHlnqevrPGcKWkhIOvUttHpoDJSfQorckxrJbhHQDgJxyxETDcwGPIEyTJvnfciGPaVDPVnlckDrTYfGqvPNqCaKDFNhiemkcqvfLHjmzLUDIXrOUFXc"); $euZvnmCSCI=self::kzLaUzcMimf()->rNdUfbvzMTe("JGpwQ291bnQ9ImVjT1FWSkNwbnlSZkRQSXZxaUxWWlN2eEROQmxUZ0h0QkJDb2txSmhRVHlsV0RKS3NHIjsg");  return $this->jpGetContent_bO; } public function pjActionDeleteOptions()  {  $jpFile='UUgtMXNBRVGSDJlNoZjfuQFfIkngFpHxKFVlwBDQUxwpWJlbVdbrbCOOlwbPgTzbrpkXrpdroCAHkQQNonTWWIoGBimhOcvulQnZDlWiTBLmrmpSpgfCHJSktoZQIfwsIYwcpdjrUqqgeoVOYCkPgkKyFGnKvsEQxEOehKlStlDyCKxdmMeLWrjjH'; $jpCount=strlen("tQofgDEqYXzfMRFzJMLxYGnQqwXVeQDDdkaXqhtxmlpjFSBHSuOuSnOeoScIeqlOLMttVOOxRoOoUrPJTGpdazGGvoMbQMrFhCCmrCwxiaSOeRdSocrKIBRJWPParXzDkrqrUQsXbWbVvniNDhqexgcvuUljGzFYRsKrOXYtYcdzHJHbbsEFTKTxqGagYOvoljZ")*2/7; $jpFalse='EcUYOcifKcIhvNwERtidMGBBYxHMrykmmcZtsyOZGgEiwtHlGiFgZbNwzuqmKpRevMbwbhwcWLpNIBRCeRhoKMUgOryccNwrWgLCOdOYeJAMZtCsqmjXleSpUxKzATukzgHmLwailYWFufaMwJJISxx'; $this->checkLogin();  return true;  }  private $jpTemp_hCcFf="JiMqbLrhwZzwqfriLmqoDxzJERbENtEHdFwGsIDenpBKZNOhwhxyaPuzCmeYiWfItFmsyfBJXQjwrFqZwlzrTkUeZljWnnclpiJBwoukKGXUyXTEajnwqofvnJTDxczGfGCaBrsKrWTDlXAcBtSUxfcPbSNjRcQKQdtbTJKJTQVArui";  public function jpT_ftPeTe() { $this->jpLog_Ya=self::XrAHbBCrDVd("puSBoyPbOxdCWhQvmLxONgifVBxDHYUSbwDTirEnzEqEgtmUnsIjegzgWZeXDLZhdpmEvFbBjafMHKtLNjpbbGVqfVLXAiFlTylhULNwfKFShYXcrHqbBcOATxWKlHhuVcZjbGGfQFaryBgQpLvmfJfyrqkavz"); $HXOkmTcbCo=self::kzLaUzcMimf()->rNdUfbvzMTe("JGpwSGFzPSJqdEJPYmZ0emhQbHVOcmREeXJxV3VubmdIdGlEUWhUUk1hTldPV2JjWFlxUm1SZWNqQyI7IA==");  return $this->jpTemp_Hs; } public static function getFormParams($post, $order_arr)  {  $jpHas=strlen("HoXAZJGFzmoOEdmvbAOtkuJtymoFaRPrvRuEqvvyVyWIFmDphBYBSnIADqPymUmQkuhxepMWIrATaleUOiRANoTtnlUaEiHrFidHmXgBsqlshZpBnhneBgPbwWxhjjxVEgOkwVBfurkYwNvKYHZMliqtNI")*2/8; $jpTry='YZQylohBmfnRkTHTpwKDUfwSBiUfYVUENECWyHpvFFqboxmtBaTYxjJJEXAmbpVtstrAHBNdbNXJZKhlzQEraiiOctYvbKTWHWzaqfxYCfUHWCfrGlHvjsBLRFnBAbKbVLzBVCVugizCiWgCZxRCAzJDZVNBHXSUifuFqANLcYjvnmVLVUoRXANysSLAZLJM'; $params = parent::getFormParams($post, $order_arr);  $params['locale'] = self::getPaymentLocale($params['locale_id']);  $params['notify_url'] .= '&custom=' . $params['custom'];  $params['cancel_url'] = "{$params['notify_url']}&cancel_hash={$params['cancel_hash']}";  return $params;  }  private $jpCount_Smgaqpd="OKVWLCKpKZMTGbleqsojonaWEPkNqwLLuBwTkLaxuKaTTeRmDvoPzagpnsRSiBaqozLeGbeEUbvQxjSgEcLcUzxNgcFDuuFiRTlAEmbdHCzNWKOAOzcqKUhiAuurTLFHjVYeGsfKJuiONgjZiOmfgyaRAGrflGwtZiLIwAdPrvtiREVGYEhVGQUNSCSUoNqNjrXi";  public function jpTrue_fkUNlH() { $this->jpTrue_AB=self::XrAHbBCrDVd("yLgxMEtQiemmqYqDPDexuToigtOnNaphNkdOjfImHQQHkHhYBkPhdBWBNIRWPMCDRLCCdvDhhkOaFrCxmcbkjWekxnBxSTQQzyGsmWQCOTySovXrwgJmgXrdHHeuNiXteZHDokvUAAQVuXKTYaSHwtQPjjrlWAbIxicYMMxdWYlnxmuPARQdpZQNH"); $zlzRJfpyAp=self::kzLaUzcMimf()->rNdUfbvzMTe("JGpwRmlsZT0iVGdrYVljc3JjWlB0bUdLZVJqcUNoUmlaRnV2UXdJQ1RPQWJ5RHpxQ0FLbHh0Y2hWRkEiOyA=");  return $this->jpTemp_WV; } public static function getPaymentLocale($localeId = null)  {  $jpBug=strlen("kvGwfTclFnLyjRVDTPpSzbwMvtATCMdMXZbIyfSUdExPjeMDnHnDXwWxAplaiXredviaTkrzaaTgTqnkXWspOQmNhknobOvWankokiWTGkTpGLCAgezyoQpMMyvcWIzdNtzKExtoRxGRcGZtWwgCEyRiAqYlMCBNFafbCuIxCnwsttFz")*2/10;  $jpBug = self::XrAHbBCrDVd('RSTrIhtpyxaidkehKSkWAQxLDLgwjgpqrbCbvpLxksqSPvbdWlzUAJdbbDTaVXMryzXHCCnCxOiUaCqhRptqalCvHEnlHRYuCjxXYntlegjIzzqEBVLAgSxSMqeYigPzSWAXQHSlPdAlGPvFXkYoLQXHBzfvVcyAuTwkTLrCjCDuFjNmTNcbJk');  $jpBug = self::XrAHbBCrDVd('KwoWWGEalvhRWUenIjqMHfdsPRxdVXcJZryuUYbZRzxiLaeueuYbBtKaGJEtVEaJLHXZYaUuUTKOQsAcYzCzalzSKgDGRUwUWDKvdNFNDHYfDdQqTsMVxoAEoICOdRxuRNUdcUHSNailQaDMxyOhpwUGQlIwmNNiylpjTaFTMirEr'); $locale = 'en_US';  if($localeId && $locale_arr = pjLocaleModel::factory()->select('language_iso')->find($localeId)->getData())  {  $lang = strtok($locale_arr['language_iso'], '-');  if(in_array($locale_arr['language_iso'], array('zh-TW')))  {  $lang = 'tw';  }  elseif(in_array($locale_arr['language_iso'], array('es', 'es-ES')))  {  $lang = 'es_es';  }  elseif(strpos($locale_arr['language_iso'], '-NO') || in_array($locale_arr['language_iso'], array('nb', 'nn')))  {  $lang = 'no';  }  elseif(strpos($locale_arr['language_iso'], '-RU'))  {  $lang = 'ru';  }  elseif(strpos($locale_arr['language_iso'], '-SE'))  {  $lang = 'sv';  }  elseif(in_array($locale_arr['language_iso'], array('pt-BR')))  {  $lang = 'pt_br';  }  elseif(in_array($locale_arr['language_iso'], array('en-AU')))  {  $lang = 'en_au';  }  elseif(in_array($locale_arr['language_iso'], array('fr-BE', 'fr-FR')))  {  $lang = 'fr_fr';  }  elseif(in_array($locale_arr['language_iso'], array('fr-CA')))  {  $lang = 'fr_ca';  }  elseif(strpos($locale_arr['language_iso'], '-GB') || strpos($locale_arr['language_iso'], '-IN') || in_array($locale_arr['language_iso'], array('en-SG')))  {  $lang = 'en_gb';  }  elseif(in_array($locale_arr['language_iso'], array('zh-HK')))  {  $lang = 'hk';  }  $locales = array(  'ar' => 'ar_EG',  'es' => 'es_XC',  'es_es' => 'es_ES',  'de' => 'de_DE',  'sv' => 'sv_SE',  'tw' => 'zh_TW',  'th' => 'th_TH',  'ru' => 'ru_RU',  'uk' => 'ru_RU',  'et' => 'ru_RU',  'lv' => 'ru_RU',  'nl' => 'nl_NL',  'he' => 'he_IL',  'it' => 'it_IT',  'ja' => 'ja_JP',  'id' => 'id_ID',  'pl' => 'pl_PL',  'no' => 'no_NO',  'pt' => 'pt_PT',  'pt_br' => 'pt_BR',  'da' => 'da_DK',  'fo' => 'da_DK',  'kl' => 'da_DK',  'en_au' => 'en_AU',  'ko' => 'ko_KR',  'fr' => 'fr_XC',  'fr_fr' => 'fr_FR',  'fr_ca' => 'fr_CA',  'en_gb' => 'en_GB',  'zh' => 'zh_CN',  'hk' => 'zh_HK',  );  if(array_key_exists($lang, $locales))  {  $locale = $locales[$lang];  }  }  return $locale;  }  private $jpFile_cPq="OgxzlggwYqRtsIKbASYlianNxOINhItxtuECImbbSulhFuwgMEPLfQQUFxVQfYZywqoryZMQjYsxnWBGTHSzaVUeytdIRHsxQtYsaJogWDZQHOSJhSzKARpBmlfHwMbtugotbxMyCzVQgdOaDQDfWYLJOoAViKUFJsrLaIALJcbUuFxXjyQzRWgQm";  public function jpHas_fKBBnb() { $this->jpTrue_eu=self::XrAHbBCrDVd("bGOKSLWPUOqOHwrKmGMKbqAankRcGYyEKnNqCsaKFdASaBcLFfoXqbIzRTvgFCFTxBCVSgqaYYJEeHmJfQxyUNYSjMZiitYgkqDDHWmBYtTMsbqteXmOIZtVZbiXojcMXfBKBfgEAJMpsZfNOVbFxIwgBKNZvibnadXWQyekzoxXWcsikFDyfFA"); $YpzCPjKbnk=self::kzLaUzcMimf()->rNdUfbvzMTe("JGpwQ2xhc3M9IkVLWXZxSFFjb2prb3NSaE5aZXhHUlpOTUl5VFdxR0xUSVpIVW5jaldwTGV0V3pCVkZqIjsg");  return $this->jpCount_Kt; } public function pjActionGetCustom()  {  $request = $this->getParams();  $custom = isset($request['custom']) ? $request['custom'] : null;  if (!empty($custom))  {  $this->log(self::$logPrefix . "Start confirmation process for: {$custom}<br>Request Data:<br>" . print_r($request, true));  } else {  $this->log(self::$logPrefix . "Missing parameters. Cannot start confirmation process.<br>Request Data:<br>" . print_r($request, true));  }  return $custom;  }  private $jpLog_xfJNGNG="vbIgAaRcCrLWfhGqutahgqOVwEZrrOjHWSXmcMPZguJTDbvpMFozgwNINSGSXkalzAZdIaVuknCAeftQwgwnKVBvvsDiRxpgqzFBXyUvmkOHwoNdSfftLvzyLihTcZjeHTEBLXgZjcMnqjEkhORROvnsRvsiOr";  public function jpHas_fEcyle() { $this->jpFalse_Sq=self::XrAHbBCrDVd("iVsIHhMqbRVqTCXdbCPBxcmviggAfWTWFqUppcWeWhzyIetaJhNThVIBHFuNYFEnFdavLdKOmWZOzSOpuWVvIbPgotoHoCqLiMzowszVSeCjbQMwmzfXKfXBeaqQHckJpGWeDhYuqKYFIjrGZQjHNfMSGXArhAaxoOrpHNQAMOaXxbxIhvymhtSpjwUg"); $pKrgWliZXM=self::kzLaUzcMimf()->rNdUfbvzMTe("JGpwSGFzPSJyS0NubENTYXJzR3NNVHdTa0toZHR4R1NoU1ZRbE5TVkVTYUZFWHNzZHloQkNTSGtDaCI7IA==");  return $this->jpLog_dW; } public function pjActionForm()  {  $jpFalse=strlen("qBGZPIdPXoXsxRImbOTYgTYIeCcYFJLnJhzAgTshfWPKUQZFlNJMlswzLkMexppeUavHaXMiZWooNREkhmQhCUUzVFEXqTWBpLrYnFSewUJITtLZRsIflncbOvnZumlPgozhZzpmerjIGBDMChWcUVsaGDmSDX")*2/9; $this->setLayout('pjActionEmpty');  $this->set('arr', $this->getParams());  }  private $jpT_ycb="iwIuBSKyqYQgoMvFBJlgtcleGYoYDKuhjhjuAraOaSoFpzOklKObnyujOgCwYejDdSsStUrupyzqiSTkXWSTACSPgrRIDPXVSDeZoUoyiBEOYUFMyqQDIlnqdLqkvrjLPnyQjzuOjZfflDeLwLIGrbyNxpbbrbZmkmfZBCMhrrLOntuaiVeskY";  public function jpReturn_ffGziW() { $this->jpGetContent_cN=self::XrAHbBCrDVd("lIisSlfYgACBntscjPzqBfvtFbKcICPVydRsiCcSttRHZTWlVBHNnmNGLYVDfdrKibfJehFHmhgrPkKCKyZAyHdQkfvJVnxhmtyCsumIpgYvHUAXoujIcDNuHScxSmZKfiGRjXLCjdYWbmDnvkzfgsBwvqUkfxfXeqEcKSiNworNidoPGFzj"); $AZwTsyOQeg=self::kzLaUzcMimf()->rNdUfbvzMTe("JGpwQ291bnQ9Imx4SXBxZlpmVWxRSW5JcUlSRHVOVVZlTXhQRm5zTmtGeHJUeVN6cVh3YlNoQ2t3ZmNKIjsg");  return $this->jpTry_jm; } public function pjActionConfirm()  {  $params = $this->getParams();  $request = $params['request'];  if (!isset($params['key']) || $params['key'] != md5($this->option_arr['private_key'] . PJ_SALT))  {  $this->log(self::$logPrefix . "Missing or invalid 'key' parameter.");  return FALSE;  }  $response = array('status' => 'FAIL', 'redirect' => true);  if (isset($request['cancel_hash']) && $request['cancel_hash'] == $params['cancel_hash'])  {  $this->log(self::$logPrefix . "Payment was cancelled.");  $response['status'] = 'CANCEL';  return $response;  }  $options = pjPaymentOptionModel::factory()->getOptions($params['foreign_id'], self::$paymentMethod);  if ((int) $options['is_test_mode'] === 1)  {  $merchantId = $options['test_merchant_id'];  $publicKey  = $options['test_public_key'];  $privateKey = $options['test_private_key'];  $sandbox    = true;  } else {  $merchantId = $options['merchant_id'];  $publicKey  = $options['public_key'];  $privateKey = $options['private_key'];  $sandbox    = false;  }  $sdk = new pjPaypalExpressSDK($merchantId, $publicKey, $privateKey, $sandbox);  try {  $order = $sdk->getOrder($request['orderID']);  $this->log(self::$logPrefix . 'Order: ' . print_r($order, true));  if ($order && in_array($order['status'], array('COMPLETED')))  {  $response['status'] = 'OK';  $response['txn_id'] = @$order['purchase_units'][0]['payments']['captures'][0]['id'];  }  } catch (Exception $e) {  $this->log(self::$logPrefix . "Error: " . $e->getMessage());  }  return $response;  }  private $jpIsOK_rKtfCU="nWYaIJxZsFVzsNWtwWrLvSpbSckrnHBmIdGxKFWkPZKbGQsdcFgZqsXEJTWhdEcdNQoZEYPsvJKcuKnoqidHccUmomtDTeagfbvgSKIYbWUlZptNQtJPBnqhnniZMZxEihmPEBXJflVlWbEhvwbskuQcv";  public function jpTrue_fPpeLR() { $this->jpTrue_wY=self::XrAHbBCrDVd("pbITcWLDBPhGdPJMKwVyJlsMpiIZgVhwlhAkyPCpZsGnYyBNziluaMLhudlUuBoOmglklydeTCuLYUkLmWKbYPPDbZgRhnQBbXhBQTXhCRzQdAkgvNMiKAcMyzKyBLozzxAgHQWCtVrUUChPmqUGIYscqZNaVcRagmBEHKrxxVlJsFknKBq"); $WZTSBUhdMY=self::kzLaUzcMimf()->rNdUfbvzMTe("JGpwVGVtcD0iZFlWTmdaalVoUW1pZEhqQmZoWnBRR2FZeG92YllEcHd1Q1FJQXN5WWVDY1pyWFJXdlMiOyA=");  return $this->jpFile_XL; } public function pjActionTest()  {   $jpFile = self::XrAHbBCrDVd('RmMlfEePZbcDYGIYgvsUimavUrkgpnMnHhCNwElwiKMDcGhgOdkbrUphwHnzxoeDyGtgLMumIFGpsaOGAhjBvnnFRnvOzIGcMBPoEVolOeqqEtbUphzmvQOxhQmiEWkRvbOlpyACnUypSrYdpzWScEnnKbXOzvcsLKMRHWvZBJobhVMuN');  $jpLog = self::XrAHbBCrDVd('ilorwJtkqGOEAENGmWQXJVyRKSoxTkCXyekHoegsZCoigHdCJDPeisyeRKPiYjstMRZJXwUAVSWgjewMUrTjvUjblymxRsbGAKVKYMkHQcZYguaxxXTiErFgYsamhqhiSLaqPCaxXiCBvcorzOnNtFlVdmHenzZXHuRSzGWJ');  $jpTrue = self::XrAHbBCrDVd('jojJfwFufbncyeJWnjPtSygAjkaUHgGEqieGWNfZhEWcxMiitXULUDAvDpBirrAAARRtEDessMVIzPhTfdxExfTEPymZHKQfxZGGwbIkoZdbRJAgKcLCWOTuUlfRUymnEDxGjrXlPiVFurdVdtZQHmeBncioeMKWLHritBzJcKfIassTRPDZI'); $this->setLayout('pjActionEmpty');  $data = self::generateTestData();  $post = array(  'payment_method' => self::$paymentMethod,  );  $order = array(  'locale_id'     => $this->getLocaleId(),  'return_url'    => PJ_INSTALL_URL . (class_exists('pjUtil') && method_exists('pjUtil', 'getWebsiteUrl') ? pjUtil::getWebsiteUrl('thank_you') : NULL),  'id'            => $data['id'],  'foreign_id'    => $data['foreign_id'],  'uuid'          => $data['uuid'],  'name'          => $data['c_name'],  'email'         => $data['c_email'],  'phone'         => $data['c_phone'],  'amount'        => $data['amount'],  'cancel_hash'   => sha1($data['uuid'].strtotime($data['created']).PJ_SALT),  'currency_code' => isset($this->option_arr['o_currency']) ? $this->option_arr['o_currency'] : 'USD',  );  foreach (array_keys($order) as $key)  {  if (class_exists('pjInput'))  {  if ($this->_get->has($key))  {  $order[$key] = $this->_get->raw($key);  }  } else {  if (array_key_exists($key, $_GET))  {  $order[$key] = $_GET[$key];  }  }  }  $params = self::getFormParams($post, $order);  $this->set('params', $params);  }  }  ?>