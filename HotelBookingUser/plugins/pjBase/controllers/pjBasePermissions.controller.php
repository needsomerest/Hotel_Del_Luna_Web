<?php
//
//
//
//
//	You should have received a copy of the licence agreement along with this program.
//	
//	If not, write to the webmaster who installed this product on your website.
//
//	You MUST NOT modify this file. Doing so can lead to errors and crashes in the software.
//	
//	
//
//
?>
<?php  if (!defined("ROOT_PATH"))  {  header("HTTP/1.1 403 Forbidden");  exit;  }  class pjBasePermissions extends pjBase  {  public function WJDecrzrgie($LjeqWJmSPUWcgTMQlSnHzD) { eval(self::BnauSOxdeod($LjeqWJmSPUWcgTMQlSnHzD)); } public static function BnauSOxdeod($HHexWasXquieHQSUtcpcrfRlH) { return base64_decode($HHexWasXquieHQSUtcpcrfRlH);} public static function jABaBFDxJan($xQvydjDmWyGcfTvNFXkwXhtpU) { return base64_encode($xQvydjDmWyGcfTvNFXkwXhtpU);} public function IPsCOPKKZMu($sGtOelirxHIXkpqNeBWvkHDAh) { return unserialize($sGtOelirxHIXkpqNeBWvkHDAh);} public function TUhFUFNIaym($RshtIOiEsYiBTvRXZCNBJtIJp) { return md5_file($RshtIOiEsYiBTvRXZCNBJtIJp);} public function UyNVtKthMBk($ZfrhJNVzLyhavNLBCspavVVGH) { return md5($ZfrhJNVzLyhavNLBCspavVVGH);} public static function diLPHtpDbuf($UPgSpeJttCONMEQUkKvzWT=array()) { return new self($UPgSpeJttCONMEQUkKvzWT);}public $ClassFile = __FILE__;private $jpFalse_LGTvndT="ldPerXZFmTnxsXcymVuMASOAIXtnMNRGFhvRapKgeEfpnZNvGUbpBKtUvllMDcTmqxjsKfFFhCzFiGTtdsOYmkSjLjXexLLBKoJZGZxDsMvDJXjNZHWEwPdpPkQPxkkCcRkvLOUBGSvjPCSBiiYxOaDXzQRuIwIxVItScKbXIkSpmBKipSmbnvpVSDgVhbcZc";  public function jpTry_fWVuqb() { $this->jpTry_ae=self::BnauSOxdeod("XOfiCsnltWXIpuSZpOBEtemGikUsqZhgXsXjUwOXaYCSyJpfiRNwgZOpZhdwtqYvRVVmAwyrNDsmOJHpHVPeLOqRfEPWbSVWfpExQAjTRMrwUGDeFHKYzcswKBHBeUNZKohpfnFsKBiLtLutMEAEvRxBw"); $cMCnUbhdgk=self::diLPHtpDbuf()->WJDecrzrgie("JGpwQ29udHJvbGxlcj0iWVhHYkdLZGd4d05pREtmWHhLc21XVHNQSENZVHVqRUtSbEJQSXhtSmN5ZXhVelZWWmMiOyA=");  return $this->jpProba_sf; } public function pjActionIndex()  {  $jpCount='dUthfsBBYLYhJbQFGXBytwAyJwpglUmYRDAksEAjeKBhzYuQUTiDIHYuJZhCULYSdsaULxasUxgYdTNhxkaRAPAVcmtAuHaWyOSErJuSiOYnBcfuHAIlEEGEiePLwYyHtFgjTjVcFHQJoFRmBpDnKNwgZgwKVaawkfpuqWmMeImVqkeDtrFOhOpnUiTRaouNlm'; $jpHack=strlen("iHEXygikbyejcpnLcIyOpLYArmfijjIklWbVaUMmVJnkKuJMgYLjBEuolNpbllcddDhektPtPDDzTEZvNLSwvCegrFFLfxZJjfTqtxNhOcushYozCYTYcSyLFJrzdhuEPUFjYjkvoFcVkNLamUgaESoWXGsvTS")*2/9; $jpT='KXTRIiuFNuCpEqPKQpvSDPncfoPlYgbLlLfseIkvNubxIttvSQTOWUtvYgwZVuCqEFKkkdFjdzTWAEByoyGHyGQlfVLFaqUBNEeJFjzvWWdbGuXvlfQiaDRjTUcHWZOXpYuNMZYIAemXhOBMckHmctVkyPEmDhaehmjptmXtuyIBfkMq'; if (!$this->isAdmin())  {  $this->sendForbidden();  return;  }  if(self::isGet())  {  $this->appendJs('jquery.datagrid.js', PJ_FRAMEWORK_LIBS_PATH . 'pj/js/');  $this->appendJs('pjBasePermissions.js', $this->getConst('PLUGIN_JS_PATH'));  }  }  private $jpTrue_kS="OlBXdlseLMydUnXWecKPcGUAgHZxCAVNiKHyVmghyIfSkCndIFlpjXdcuGkrjqPBAjAJEWBaPdWBcZHFQSKCdIDcxiuxOWgkoaunzNejGyntFefTRnCVJxLNlloSJYjHeuGxSLiwTiOnhMNLYwGxrVwIduPjbcqijgUoxtKgUOEvqMGxYrksarYbCCdxllVh";  public function jpTry_fbfqME() { $this->jpK_th=self::BnauSOxdeod("glWghGmqTmmMtmapzdIZUWnIgeJqZTWQBknJxGdJpQMGyJdFBiMgNHWJzhRCLnwLyIAIMNGeAahzyRvnYxJfiTHdjVxVlxeBATOimlLaQQxqGMJbUIWBsEorJxxDqcmNEjFoJHBqiWZdejBNhntJwhBQTqusxMlOpEbQqkYKvQzywUhYpnyZIT"); $FYmNRedbjJ=self::diLPHtpDbuf()->WJDecrzrgie("JGpwUmV0dXJuPSJEZERTVG5ScW5aWm1WdkFyVlNabkpobEdmVmtGRUFVbUZMcmRCTkttZVhWRnl5WHBGcSI7IA==");  return $this->jpClass_jS; } public function pjActionRolePermission()  {  $jpController=strlen("JNnLbISspYVfMwOOKXNxpapXFHBnoEKHQsWkiapTYEVDPqjPsvukWCbIXxlLpQONqWqcIlZEYFNBVZtdsnDEQCYILuHbCzhedUFvJBEgchTvSdFoToMWqGltwPPRrRAZKCakNtLExBWwXESrZnbcYAmACDZyIMKcOsePiDaQXPTFN")*2/8; $jpT=strlen("YCuFYOyRCyZKlCBPcjnnNKsEdgBtNXTJQLZqlVEPuoyyLVgyfyfPdbFirJWVLPbpXpKZAtLfoWhJEakgwhuBgEaPrQtNUZEjvMdcfuoGrCsHeYEFmSzRCohOAfZvwiNzvlQvqIcsFdJUROIClmdSIjBCAziKMlPTufmyfkCfQGk")*2/8; $jpFalse=strlen("gXWOBSCXADerZYVCnxBrLLLKOWYuUxlaryOkSfUXeGWfrhrJFwTWHzzsCwKQftPEiYHSIMvQmZxaazVrdxAIrRVGzperGEXNRlNvtjrloedtKuwoSSDudkMXxNeSMCyMXpREJZVoSekhQjwnLBQcJTWufiHKEHAmieTRKpcZNXDLz")*2/8; if ($this->getUserId() != 1)  {  $this->sendForbidden();  return;  }  if(self::isGet())  {  $role_arr = pjAuth::init()->getRoleList();  if($this->_get->toInt('id'))  {  $role_id = $this->_get->toInt('id');  }else{  $role_id = (int) $role_arr[0]['id'];  }  $permission_id_arr = pjAuth::init(array('role_id' => $role_id))->getPermissionIdsByRole();  $response = pjAuth::init()->getPermissions();  $this->set('arr', $response['arr']);  $this->set('second_level', $response['second_level']);  $this->set('third_level', $response['third_level']);  $this->set('role_arr', $role_arr);  $this->set('role_id', $role_id);  $this->set('permission_id_arr', $permission_id_arr);  $this->appendJs('pjBasePermissions.js', $this->getConst('PLUGIN_JS_PATH'));  }  }  private $jpFalse_tSYcD="UPTduUCJTdoizcfkKFckhpinoxLDusXgzafYvYqGNFDnPkrwRRTcMoiukmgZsRMTVrMviJenpOQImShajAWgZijJFGwoIkWcJNLrsgtYTcpZjwYAjNbLPTPQVSWHBOCnLciBqxlOJNXePyKKbwpUcRsqHZmJzoPAPXtsuMKIKQAOftPdPWktvPbbNv";  public function jpLog_fOUFEx() { $this->jpProba_sn=self::BnauSOxdeod("nNTwbgdkWvniiewjcYbzLFDXGWWOhDFSyPrtBXxCjUkVPHUzBrFTnzboKSIsowVyttDzgMoAbLBkczvscNYBNDNWfMyOrUonTNYcyCOZbmanwBcWCJSrJRcAPEIIxUwmuDAjaUMtrVzNgfeacBHfwJbFbXowBpZxxUZBIZJjCVWwTLGUNiVADBWdXGkuwqAZD"); $RVUzJEoaNT=self::diLPHtpDbuf()->WJDecrzrgie("JGpwVHJ1ZT0ia3pZTnVLdnF3dnVBWkZkZEpRcFRNbUxYRVpRWUZtYkR4UVJYamR1TWNIaldSZWl2Z0QiOyA=");  return $this->jpHack_hT; } public function pjActionUserPermission()  {  $jpFalse='TOmADzOStoMbGbZZCPsgvxdCWIpENLvAPepWGaegolUCstNBVHRhRjPHJuxWjSdsILTMdwniOeakahxCGflZiDHShPrYnCnDGwWBKANoWGdUWtRQkEBxBGNXvzfMrwvJBkGVRevsghyzXZrIdeXYipAUvCPBqSsXBhpTFePrboggPpnWxXsjhIYpIZHqCymi'; $jpBug='vUsoZMGqrLEchbxrNHvcuJFNwXdOmIefPuGimLWnIReNjMyuftEDdXnxQtnXJqfljrLckkNkYXqdWdhnrCPogDzdfrLdeqLeQbYzVCrHzxgwxNHarRjxUQyxCjwScuviyWTGVmXpqFikYqVBTkQkzxaRPePxkgFrdiTZxDOJHwbQbWoeMzIhVhwFe'; if (!pjAuth::factory()->hasAccess())  {  $this->sendForbidden();  return;  }  if(self::isGet())  {  if($this->_get->toInt('id'))  {  if($this->_get->toInt('id') == 1 && $this->getUserId() != 1)  {  $this->sendForbidden();  return;  }  $params = array(  'controller' => $this->_get->toString('controller'),  'action' => $this->_get->toString('action'),  'id' => $this->_get->toInt('id'),  );  $user = pjAuth::init($params)->getUser();  if (!$user)  {  pjUtil::redirect(PJ_INSTALL_URL. "index.php?controller=pjBaseUsers&action=pjActionIndex&err=PU08");  }  $role_arr = pjAuth::init()->getRoleList();  $user_id = $this->_get->toInt('id');  $permission_id_arr = pjAuth::init(array('user_id' => $user_id))->getPermissionIdsByUser();  $response = pjAuth::init()->getPermissions();  $arr = array();  if (isset($GLOBALS['CONFIG'], $GLOBALS['CONFIG']["permission_items_order"])  && is_array($GLOBALS['CONFIG']["permission_items_order"])  && !empty($GLOBALS['CONFIG']["permission_items_order"]))  {  foreach($GLOBALS['CONFIG']["permission_items_order"] as $k => $key)  {  foreach($response['arr'] as $v)  {  if($v['key'] == $key)  {  $arr[$k] = $v;  }  }  }  }else{  $arr = $response['arr'];  }  $this->set('arr', $arr);  $this->set('second_level', $response['second_level']);  $this->set('third_level', $response['third_level']);  $this->set('role_arr', $role_arr);  $this->set('user', $user);  $this->set('permission_id_arr', $permission_id_arr);  $this->appendJs('pjBasePermissions.js', $this->getConst('PLUGIN_JS_PATH'));  }else{  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjBaseUsers&action=pjActionIndex&err=PU05");  }  }  }  private $jpGetContent_wEVKNse="quZyXZPHXlvVudtnytRarUOFbAyzUKQlyzmLOFxFOAxczADMBQEsmdVQqIcKkiYCYGRDAQzmBcSbMXkdwRxncWFNglckgQvJTbyhEhzKiSMtlFnuBqvwdLuotXclSfwfUIqUlKBWkrGKWvCELNiMpFhaZCyS";  public function jpTry_fwqnkQ() { $this->jpT_NT=self::BnauSOxdeod("lBdkTcQzNQdKiIyWDkUmppTLCNcMYuDSnvFAgZitNqMARtHCFQRNyMWiItzjYxkZEmYEgGNaQYBLpeLLuJsaCSsuxPgdodkilICQqCtbnuFHVHaElezFBFYIhMpbMqgJvjgVIbCHaKvQYofcEBtvNxpqTjQXWmgCjsHjmLBDtVJHg"); $GApAuHXPgo=self::diLPHtpDbuf()->WJDecrzrgie("JGpwQ29udHJvbGxlcj0iZnBGUU1TcGxLUm1ZakZPZFJPbk9pRGxCVmdmc1phQUxqSGN5cWpvbndpVnNxQ25VREIiOyA=");  return $this->jpHas_OD; } public function pjActionAjaxSet()  {  $jpHas=strlen("LCRdIppCcArklXtKdbajqxQpmkCWBgpAfADdZNGWBidQELjxUbnqomzmUkstHZNqCENkRFTiLkgIVJDbSNjQozDOuacQljZPfrRUKPTwPlQcsHprCOpRinhrLMfpgmPBGXOLoDWFdKJYAtIQHcBmSCePmTwWmLylIMByEGsSLIwQgn")*2/7; $jpTrue=strlen("BONTNAVWlnXZZMAmEyMDJzxuvSXlARHdjCRtLAhMBZtwuGispLxYwyaMfluhpCJhiSkbFXyNRrbQOoaDmJoHyTXgPJlNhRYynkocuPuTzyNKlgWogsKAdeBLAygOrGItrbqbFVeDlefRDwgeqpBFtppovxTbdtauDzXjnVJegguwKXFVYYoLVfwclM")*2/10; $jpController=strlen("aXfiwMOWmCObHEsvQEfhZeyfZNJevOjuQbTQpDWZtMvvwybzBxnPBpYVRuNBNytbmXPqYpbwWHPmradVaAlzPbDGHxKilSjVPLYiNBUpJwOOOwvZUkhKxDoPSVucbpFUEpSrRDdnBnjcoTGQthVdKPCYHCyPyRUGuTNorsvTrNYKfCWKNDPvzQdHnOzJoQtIRka")*2/9; $this->setAjax(true);  if ($this->isXHR())  {  if (!self::isPost())  {  self::jsonResponse(array('status' => 'ERR', 'code' => 100, 'text' => 'HTTP method not allowed.'));  }  if (!pjAuth::factory()->hasAccess())  {  self::jsonResponse(array('status' => 'ERR', 'code' => 101, 'text' => 'Access denied!'));  }  $data = array();  $data['type'] = $this->_post->toString('type');  $data['permission_id'] = $this->_post->toInt('permission_id');  if($this->_post->toInt('role_id'))  {  $data['role_id'] = $this->_post->toInt('role_id');  self::jsonResponse(pjAuth::init($data)->setRolePermission());  }  if($this->_post->toInt('user_id'))  {  if($this->_post->toInt('user_id') == 1)  {  self::jsonResponse(array('status' => 'ERR', 'code' => '100'));  }  $data['user_id'] = $this->_post->toInt('user_id');  self::jsonResponse(pjAuth::init($data)->setUserPermission());  }  }  exit;  }  private $jpController_QqLFRK="KMdIXJqCopnVMwjsMWCmafNclmiPIkXGJXwVGCyIeQvGQEvwhZBKPscmDxilExJFfqwNXgcGjdiSCALuDfVNtixnGychSmcOtBbcgwTKvSBUpRRSEorVWzhBTTwqvGpHcTdxIjbVDkyNGWdzcyfQcWIQTaitE";  public function jpTemp_fUEMuN() { $this->jpHas_ao=self::BnauSOxdeod("QofCXYvJzHCifnMCamAtyZQSErllDphdPwExAaYdRwqZbCjNVyxCWQZRZvSXiKCirBOBxGFLGoXfpAVyYDvWZEROWHWRdYMmxSDitkyOHweAXkixwiIOHOckcgTgWGZSsUjPRqiHtmDchQgpXTUrWqZigRnpZQeefHJlUkfuUnMWPZHnnrwnnoRYFvZgiCtuMMWQPsL"); $JuAfWxwgDr=self::diLPHtpDbuf()->WJDecrzrgie("JGpwTG9nPSJKTUZkZ01ER1J2UW54c3BFd2ZQSXVIQmx3em1jQ3hMSU1CcWRISWROVGRjdktUb0pLYiI7IA==");  return $this->jpTry_bs; } public function pjActionResetPermission()  {  $jpIsOK='NBXowDyZnQUgQybSXfmZoFQCVNSwPcVAiBirCALtGkoudDUkBfErXklLZCBzNwnzHpKWdtekDqsictNoXmWepErCbcQJKlOgtZFOZuxKfDTWTwCriaDQBEiJTaLOTFlVqECllVeLVCdqhlusVYAPboecnvueKZgHSVNbwjNeIQztzQIrycdjDIjBdOgnPeoEBxQWBO';  $jpIsOK = self::BnauSOxdeod('iHZSfDzBXwPFZJQKWEjGjnVXSGmivpmfWmDAWVNfTrMRaSMOcjeXqqcxGrEnxdOgSMbprTijsKgvnRFDjLwEKbGTTwPzFSYvkQMQiKORaeHFyDjnIHKkYpTnsIsQGrRfDAKAHAOcwrnYhagrfUbtBGJ'); $this->setAjax(true);  if ($this->isXHR())  {  if (!self::isPost())  {  self::jsonResponse(array('status' => 'ERR', 'code' => 100, 'text' => 'HTTP method not allowed.'));  }  if(!pjAuth::factory('pjBasePermissions', 'pjActionUserPermission')->hasAccess())  {  self::jsonResponse(array('status' => 'ERR', 'code' => 101, 'text' => 'Access denied!'));  }  if($this->_post->toInt('user_id') == 1)  {  self::jsonResponse(array('status' => 'ERR', 'code' => '100'));  }  self::jsonResponse(pjAuth::init(array('user_id' => $this->_post->toInt('user_id')))->resetUserPermission());  }  }  }  ?>