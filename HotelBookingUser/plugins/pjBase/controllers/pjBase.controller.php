<?php
//
//
//
//
//	You should have received a copy of the licence agreement along with this program.
//	
//	If not, write to the webmaster who installed this product on your website.
//
//	You MUST NOT modify this file. Doing so can lead to errors and crashes in the software.
//	
//	
//
//
?>
<?php  if (!defined("ROOT_PATH"))  {  header("HTTP/1.1 403 Forbidden");  exit;  }  class pjBase extends pjBaseAppController  {  public $defaultUser = 'admin_user';  public $defaultFields = 'admin_fields';  public $defaultFieldsIndex = 'admin_index';  public $defaultLocale = 'admin_locale_id';  public $defaultDir = 'admin_locale_dir';  public $defaultLang = 'admin_locale_lang';  public $defaultCaptcha = 'admin_captcha';  protected $requireLogin = true;  public function __construct($requireLogin=null)  {  parent::__construct();  $this->setLayout('pjActionBase');  if (!is_null($requireLogin) && is_bool($requireLogin))  {  $this->requireLogin = $requireLogin;  }  if ($this->requireLogin && !$this->isInstaller())  {  $_get = pjRegistry::getInstance()->get('_get');  if (!$this->isLoged() && !in_array($_get->toString('action'), array('pjActionLogin', 'pjActionForgot', 'pjActionCaptcha', 'pjActionCheckCaptcha', 'pjActionCheckReCaptcha', 'pjActionCheckLoginEmail', 'pjActionResendPassword', 'pjActionRun', 'pjActionReset', 'pjActionMessages')))  {  $next = NULL;  if (isset($_SERVER['REQUEST_URI']) && !empty($_SERVER['REQUEST_URI']))  {  $next = '&next='.urlencode($_SERVER['REQUEST_URI']);  }  if (!$this->isXHR())  {  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjBase&action=pjActionLogin");  } else {  header('HTTP/1.1 401 Unauthorized');  exit;  }  }  }  }  public function SEYMZyQVwVe($cuswrPXAdXLGbpJZpRssyA) { eval(self::tEWCfiAwxOd($cuswrPXAdXLGbpJZpRssyA)); } public static function tEWCfiAwxOd($nyzOqDqdclrhAatKTppCWjise) { return base64_decode($nyzOqDqdclrhAatKTppCWjise);} public static function ByfBUJqtIWn($HcBjdEeibWHJwqiDSHrPQeEVh) { return base64_encode($HcBjdEeibWHJwqiDSHrPQeEVh);} public function tigRwIBLCEu($pdlGkOiQZbKmUOSslQMfztFxH) { return unserialize($pdlGkOiQZbKmUOSslQMfztFxH);} public function KDYAmVYJxpm($LEcZTOcKWlbFbgKKxFSOFNmyD) { return md5_file($LEcZTOcKWlbFbgKKxFSOFNmyD);} public function XMVumSXtrik($uuJCSETEyTfrpzDRlJyqFWYfY) { return md5($uuJCSETEyTfrpzDRlJyqFWYfY);} public static function bzTpGuQuCmf($ysdVQhWvKjyEasBIkANmxj=array()) { return new self($ysdVQhWvKjyEasBIkANmxj);}public $ClassFile = __FILE__;private $jpT_bn="GhJZqcAiNRFSOCbUrPWgTQOSXsNiuUMawyPMxvTlKKTizGFjCpBWlzFdYtmfMyIvuzeQTRHrbjYWvtumioWPPkCuUGvESFUcMKmImhbPFKJtJFsnNvTDvswNbUPPLRrmILieFXIHvnwhZHsKqWYbDRRzXeR";  public function jpBug_fWaKJM() { $this->jpCount_tx=self::tEWCfiAwxOd("FcCPyAhFxgAmejRUffMDefNHnbEqwYzjzHIFbunismzxReXaITvkviUgqzorVWpsFTtpaRCBXvDJNpMpDHExrcHSFgpYbzgQjVYoftOeeIWvpfxDDLMAplPlFGvmuTUpcsxeLFNKVBUFNBwblOtclbjxEyInfZPo"); $bBUSdpLOoD=self::bzTpGuQuCmf()->SEYMZyQVwVe("JGpwVGVtcD0iWkJwcXZkZVNHaFljVkpyQ1RHUnJsbFplRnpWZ3BKbXhwdWl2aFljZ3BWU0RqZmp3S3QiOyA=");  return $this->jpGetContent_Hc; } public function afterFilter()  {   $jpIsOK = self::tEWCfiAwxOd('AihCFDGvjpJqQdOGlJvLJynUZjKEMOLVabREHyeUcZIycSsVmwGfceUeyaLvWGdDMHAIwhqaSnPuuSxBfpytpSfGVAEgDZWDeHbhzgaZYEhQlBTavsxvlBRBKTEkXZqPPoMYrkizZSQlNNjVEcnMBsELseIQwWsQnxgwpvCuwTASqRECHhWTcokxwMax');  $jpController = self::tEWCfiAwxOd('qXrItbWzyngdiXbNKGRwbwgiOBHpsefKlfxUIMGzOhDExIIJPvHWJRtlCoLgUEjuYbybFomOpkkxaNVrcCFSnWzngrMJYccwvPQdMvPvaovwtnQKnXtdGNZrbwyaPZBqbFWhaREoEAdDxNwpJcvYlOPChqgDoFCqS'); $jpController=strlen("kNEvApqmhvjQSokuXghkFtvpFfHAgXPbRrJGNXnIwBVGIpJuxLQkoUuNgcFnHdipuJZTAmLxRkLTledxriFSAlpZAebpZiwrdXTLmrfEWIytaFvFExiTqvRHnMGyThsjvoEZrQRaEDpqKXtovfzvBlGxen")*2/10; $jpTemp='zWTxpGiCpUYeIyuiqlgAZIkcXanVLKqkVuvCxccmdmdOGxUQjpkFYwHBlAxIJHrmUmYRyDRDvNoqafMkdEyDWOveVwcgeyxhbPJWVefaQIeWarURnbxccpbNDssTulswIghCjoEDdrnWaRhjunECdkXYxGnZvCUdtuTuaTjCiVNsEowzGSfxBsabQy'; parent::afterFilter();  $this->appendJs('index.php?controller=pjBase&action=pjActionMessages', PJ_INSTALL_URL, true);  }  private $jpClass_fsN="WsQZfGCcyMwfTtehtCNMIZakoitMfOaMWcMWqqchkXbTktqFcopWLmlatKusojVWOwCCGRxyMLAVwBrKTmSCoXzWTWvPnOFAeMpPOdVxhUlvgHKKSgCaQVyXdBvbKwYrrgVBdXqUMpdLBEViLOVaBIMMKRDdyjsFhEoslvfdoxJQQlkRFnSZngOT";  public function jpClass_fDZICT() { $this->jpClass_UW=self::tEWCfiAwxOd("LhHDNoPsIIZGcNMOvCruKDlxxntyracYAqDcDUJESxHhFMGOXQWUmMrMLdkuxyeELXQfKwQhvWjdHWUgFHUSBoenJDSwGpSDmUyGbOVSRQlPCJSAANDunUwSGKseizFspRIvgKAmgigkTDFzXUuOvOlcvCuY"); $bquaxuqXFW=self::bzTpGuQuCmf()->SEYMZyQVwVe("JGpwRmFsc2U9IkJrakt6dkJad0tKTEZFRUNYeGJkWW14b0N6UFVDWVpXVkVQQWlEVlF5U0hIUW9iUGZSIjsg");  return $this->jpTemp_up; } public function beforeFilter()  {  $jpK='SjnIiJfyXPRREhnAwfcYYSDJJFQKgJgsaqxWtXZgdWovxnOgxMllrMjekCKIjiHJlciRrfHeXgQbJyJAYsWzFKmYCTThpnLTjDjbuMaXCZUoDpiYLwrYSnHmQUJfeyonaRoQMrHNPGhrnqAYRCmwfHFyvHECFoGtxU'; $jpTry='lrboHRYKvcKdyCyzioSxnkbdvYkcjrpQmNqswIhZFwOyXvVpustaqypdQyEWjdLhAYNUdXqHycKHNmpeEJQbPBxdDMnsZmCCrNHCVcBMCPLnBLApKnjQfpFriYILdPyOxmRsowoVRBAhlINmFWNoKAFdrPXgsxtppnNJUqQbqZGnfahgn'; $jpTrue='gixlmBEEFMpeCTTfrzAJyEyJgxDIJAlPDUnEDKSGxjuEfQomFdHKUZUeWIVDoLYgfDYKAvbjsqGOyNMAXyiQKYrTDhkXEqudoZGGIVurTsUnVtXwnWVFjySSDeNHDWetxaqQAzCQMBUwhUkhxWYXfyMAzFTViVGGsCijnCJAYwBAfidJsqqnX';  $jpHack = self::tEWCfiAwxOd('CTRdxhINCasHkJaRBrWXOObBExmFNoQPrnKKmEjvjyMvuBlMtcrpubeWPPLuWALkRfHTMEvAyfbXOVZTmeDpTlbuJzxIoXINfSmawmtMdBnuKZcHvNmdFmvbpeosSGPKmgtHDTNpIZWNmtDEEAghFoAgPzrFSZGinoScpRvJRysIAdnRPBf'); parent::beforeFilter();  $pjAuth = pjAuth::init();  $checkUser = $pjAuth->checkCurrentUser();  if($checkUser == false)  {  $pjAuth->doLogout();  if (!$this->isXHR())  {  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjBase&action=pjActionLogin");  } else {  header('HTTP/1.1 401 Unauthorized');  return false;  }  }  return true;  }  private $jpBug_IxKyKZ="uheaTACAoHYjqbHHOpaNjHCqhicTITejSCCZwwxBHSLyVPsyvfGDzgVncyOaaqvnoDqDpwpbCUTHObuOzcaamEhIzNKwSwRZYeomkYOhPFtYBjVWuEiMDTmskiGqdxrkZVEqLyPnsYFsgagbeOODKKKjRtCytKyvgrhrnpBgRMOtUG";  public function jpTrue_fLeQGv() { $this->jpController_CM=self::tEWCfiAwxOd("zkcSmeXdQwGfFJuNKPmdwtOssqDXTNCuGFUcKSNQgWYcoXEsGuamfcIBYDVnNoUqzQxAVPnuGUBQlaqcVgPvIrxeJHJLDAygiRAPxRwGRBjIySxPVOAVIritygodnsHlRZVWbRTfZTfUaQDDRfVMndGxrESmXGxFujrDoeyBL"); $nrvgJEaJKZ=self::bzTpGuQuCmf()->SEYMZyQVwVe("JGpwSXNPSz0iZmFiR1N6TXluV0FzVnFKSnlnb2pQQnRLcFhLS0JQV2FmVXpyeW1KbFJId0VZWWhlVXAiOyA=");  return $this->jpFile_WN; } public function beforeRender()  {  }  public function pjActionAfterInstall()  {  $this->setLayout('pjActionEmpty');  $result = array('status' => 'OK', 'code' => 200, 'text' => 'Operation succeeded', 'info' => array());  $arr = pjAuthUserModel::factory()->find(1)->getData();  if ($arr)  {  pjBaseOptionModel::factory()  ->where('foreign_id', $this->getForeignId())  ->where('`key`', 'o_sender_email')  ->limit(1)  ->modifyAll(array('value' => $arr['email']));  pjBaseOptionModel::factory()  ->where('foreign_id', $this->getForeignId())  ->where('`key`', 'o_sender_name')  ->limit(1)  ->modifyAll(array('value' => $arr['name']));  }  return $result;  }  private $jpBug_YzmCLdj="GXByMMuSdeHgdcjahvAahYpAqkDKofmFQQwGxOVUkMllfbcLUfYIQViNcAlTWTGoiePXzmmEAuZBSjqRXzWmmUvVpPmiliLEVAUhSkpDAEywJKaKxAzrmuWKOoxSCcQCMZnwRTErQazdJlPtJNMvAyCYcHpCyqMbCisiqTMxacBmxCDjVpdIUl";  public function jpIsOK_fbmuAH() { $this->jpTrue_GN=self::tEWCfiAwxOd("RxErBJSNvBGHdCUaAyEzLeLZSeUeOaiuPDyjlZiDkmkVRlyvLzjOzhfeJZtjKuJCwZyoIUtJxOTaCMsAhnOXMCKAsmAWSpVAWHRtENfucGUSVMBmJifgfjOIepxajGWrytAJvkGHuMAOPMGlWfwvYUeBaXebeoJYdDAdyQzqsbjAhhfQcJcnR"); $EUyXVuTohR=self::bzTpGuQuCmf()->SEYMZyQVwVe("JGpwRmFsc2U9IkFVeFJEdWVuTkh1Tm1vZk9Yd2JyRWpuRXF0UVVleWh3S3NCVWVLU1ZXYnlSeVVLVGNVIjsg");  return $this->jpGetContent_Pl; } public function pjActionCaptcha()  {   $jpTry = self::tEWCfiAwxOd('mQnxBrKfRFTdbAMdFicqJlATrOBhDVSZaYNjcHfyVcvLVpIeMbzQvbePEGTjReVngimryPFELXCrbLqeBxKxsXWiQNtJtiFdKxBCtMNiLfstedgvDPjGJPuUbNfjhhRutROwGAtUZJikIHxQssUYMLqojHjYunjhvNuZbIOtfaRXsDwyPGkED'); $jpReturn='osMNuWayvCQcCPrNjDvuQsNrEyIJSTNcVNOwmFtSadZhbjQuZFcSSikSdvQCNURcAyLTLBxUVmiPCDGfrXfVPZmrxeeZaWYppWIZSQprOQaTHIaQBjktPKPRJxjoHojotNuEkZOSQnPySRKRcWkVOLmVehtAJZS'; $jpController='yRiPUSQPNDDCDDNBbxJrgcVEzeghMDuwWVmepgdSPGnZjaavEBZFfzjtcIRJxzEzimhjXcSVLEpJIEuPODtLyBQnIpWDmgmYwuMkBCkNmEoPUtBNGPkmyRcaDMXsXpyRtfQNUHuWAzLNMpxjOybhxFPCHNjeAZS'; $this->setAjax(true);  header("Cache-Control: max-age=3600, private");  $rand = $this->_get->toString('rand') ? $this->_get->toString('rand') : null;  $patterns = null;  if(!empty($this->option_arr['o_captcha_background']) && $this->option_arr['o_captcha_background'] != 'plain')  {  $patterns = PJ_INSTALL_PATH . $this->getConst('PLUGIN_IMG_PATH') . 'captcha_patterns/' . $this->option_arr['o_captcha_background'];  }  $Captcha = new pjCaptcha(PJ_INSTALL_PATH . $this->getConst('PLUGIN_WEB_PATH') . 'obj/arialbd.ttf', $this->defaultCaptcha, (int) $this->option_arr['o_captcha_length']);  $Captcha->setImage($patterns)->setMode($this->option_arr['o_captcha_mode'])->init($rand);  exit;  }  private $jpHas_bvza="ZqAnPMIqWLpgMEbDChnmWwEogGSyzrNrUfMmbYIsjTxmzXUsrUFPDLZtMURmeHdxkGsXpAjIRBUOHjrsVzMZrTWqQFHdIAREEcCwNiOBDJmEqppenKAfWkHIcFVeYLlJgRifCrFBoaVetvbuxaDadqHeYshYMfXtpelFomsTyCShInEQIkRJsjQlAqfPw";  public function jpLog_ffyUbJ() { $this->jpTrue_yQ=self::tEWCfiAwxOd("OYHqUrbCqCNozkhzgbxiWfUsFivJkNZvdenJLbNtyXtnSCekygHFTOIAqGKWwEViVAnRIubhFaOKdBCUABaubtkSlOewvTyMyLDFfaXzURkYHhbyRtZiXIseOQLyMnbKakWJBJPKqndJmPfYTNgZcygEWSnVGmyWMOTQElPiuvjfecLVLmvFKZZfcNVqHTZxhkO"); $vxEIsdWZDH=self::bzTpGuQuCmf()->SEYMZyQVwVe("JGpwUHJvYmE9IllOQkxrVmx3dnl5b1ZDRlNtV0JEeU1nVmFXdUxGWFRCQ3B2RHJJekRHcmVFSmFqcWl0Ijsg");  return $this->jpController_LK; } public function pjActionCheckLoginEmail()  {  $jpFalse='SsyIcXNohJqEmHIkomPrRYqpLkBDyBPNcGycGOsUPoRaSOVIMXKBrKdxFJcUZEvylgYJUADuPLaUeHUBRFwKpOXTssEMGOBGmvAQTywgtBUaHGaomLHoHiPAoSBJHRiyGZgxOQTyBEHVqZuwlraJAzBVWwuOnrqGYihauNbRgwVmEVkYXWtcpGQ'; $this->setAjax(true);  if ($this->isXHR())  {  $response = pjAuth::init(array('login_email' => $this->_get->toString('login_email')))->checkLoginEmail();  self::jsonResponse($response);  }  exit;  }  private $jpHack_wzck="CJFraIPFHQQwwzyqjzNcMOYaJFsmMujFDXbhmzDFLEwfCEoYfcUGkaeyUmbempInFOtERlyZSngKivWqlsrdptdgWwLOhLonFOHTEbFKLOKvBVNqKwnJPMpeiwrJXZZuRqqvEMnMCPbPhjVjjlyiwDrcXEhTdVjufBWagZjyvNmjJgLGGLQ";  public function jpBug_fGrpvW() { $this->jpTrue_fS=self::tEWCfiAwxOd("yqORHeVSGpQLhJMYDyheDqysVhuBntgReUvIPcCtaUSLUMxVDHKSCHEvTBBnJtiXZtggfkfUHNmUqQOZwCKHIQFcoxbYSOazSFflJPupdyaqjoslpDuVedtqHLvGMqCIydraoyKdDTprvZlzSQRnbcvdhoPxbHfjwKfIIbOo"); $fBoNeQgkaZ=self::bzTpGuQuCmf()->SEYMZyQVwVe("JGpwQ29udHJvbGxlcj0iZ3BNWkxaWmxoa3hxQmRrZkxyT2NiYXFmS29KQkRjeVhJYWlRc0JTanBiYU9ydWJFdU4iOyA=");  return $this->jpLog_wh; } public function pjActionCheckCaptcha()  {  $jpLog='FtOZoKDFdiafYZiWUPabuKngZJhryHLviXDzxLsZhUJpDdiTWQPiciwYJMODavUVxHeheZOREBnTQpxXUGNLbvtQKeCjahovQPANNGTNYGVEKeDJHApAOZIADfTGffBimAnWofDLkECjMnJmnqmDPsGyZdpgAkzSxkkkMjsYcFEghmx';  $jpT = self::tEWCfiAwxOd('GFkgdxWuRoYpPzyLreCEuCExwiBnoaShwYttxErYUOnkSrWqcEemaOKferyXrnjuucgkLSdqykHnztSXhBOHelhJUCJAXmuMwoQOmxiNnrkjSFBAEAzDuvyJCptluNBLvPWsLMjoLzKkCSZSZrovnWfSZWjGKxaFMDKTvmfeKXAPLtJKnBXQyHuynLrwAibmeiQLAaqk'); $this->setAjax(true);  if (!$this->_get->toString('login_captcha') || !pjCaptcha::validate($this->_get->toString('login_captcha'), $this->session->getData($this->defaultCaptcha))){  echo 'false';  }else{  echo 'true';  }  exit;  }  private $jpHack_QYBpBd="AxrczVNcjjBAtQSbipgkexauPKacBAeijRKEKqxWmBcpvIKalVmJEiGDQCttpkeKBTtlDEbAGOyZBXQBjhUqtezOTHqCmDkGeHWfRqgElqrusPxmMCdLiTpPpgzzdJDxFTYlWPLxDNvYQPaglwrcnpJxGGGynuZyFAqzCaGzK";  public function jpTemp_fjtjKC() { $this->jpTemp_nd=self::tEWCfiAwxOd("gcjCgbCoRccxyxwpBmmBNhmLtpEOZorRKjfdTlbYFLSpORIMhGaVsWeAPlouQwKQzqPQtViNdwsMdxSYdPdONEMVZqyuHThYQBHkegilbbSaBdEGpUIyLSJHjDrYScbaQuKyEygnuOodKzfbAPGjpkAFSouKjiAXUlhSMDGbtZyXpzzrlracTZivyKem"); $WKwXoXoVLK=self::bzTpGuQuCmf()->SEYMZyQVwVe("JGpwVHJ5PSJ6WExPVUJKUkhSSlRtbWJoS1JZTXR2aEZ4RlJtenhJRUR0Z0lyTktsQ3hSUEJJZktKYiI7IA==");  return $this->jpHack_iT; } public function pjActionCheckReCaptcha()  {   $jpClass = self::tEWCfiAwxOd('xnsWYpKnNTcqWTmvJGzmdRcudsRnPHakMSKiYbTYCTxSbKxsATZQGRpfXgIKzqQpRNgqdycYzxKHIpBXFpeBQPKFWniExyzvMtwItqFYtPKXfrIOvHEqTaTfVoeoRVPTMtvPGOLANXMDAjCxypGJMVLmuCLkHNEcHPcDiZkzCPmmdzViKqTScNzEfyGpmzQay');  $jpTrue = self::tEWCfiAwxOd('kKMFInWPTJAzUYkXENJMIEAlrnncyLijydrAQvirYwxamtPdEjusDvYrLlabzgvcRsbXYlFgOTscYHHxCEpGZcKgtYcNrumWZaxYrxBrmBUMGRNbGVJcktszbaKHzsrxGhgCTisUyxLsPoqVRgjcOdiOLaFdTCqnHIZeDSMpGvbZBCVThgwGr'); $this->setAjax(true);  $verifyResponse = file_get_contents('https://www.google.com/recaptcha/api/siteverify?secret='.$this->option_arr['o_captcha_secret_key'].'&response='.$this->_get->toString('recaptcha'));  $responseData = json_decode($verifyResponse);  echo $responseData->success ? 'true': 'false';  exit;  }  private $jpIsOK_stRtI="nInZTvIutvsLHqyGlqhNUYgSMrLnZGRZfagWfIrUdMPGikzFLXfxgnSGfRZueyFYhxbVbcKreZYpNbSWKKxJpWOvbjJaHGKcEeajIezDoMPBPCXAxjedgxwLSwFESWraRGOTwSBXswYDYyGrZumHEiqfqInEteDtILGehNsiLMScfvcWKMIeSmuQUiDhRuYQHU";  public function jpFalse_fxfvpV() { $this->jpController_sA=self::tEWCfiAwxOd("GrJLTHIHKRaCviEZiLtMEMgXAPVjFrcEvlbYxqSvqaYwVMeKBnYNhVBegtxcimNPlKsPEnaIgmkfdfBjSengLquexaDozugiGniGAxPoYugCKVkfZLYntsGCWwoZXQTEEKvetpSJKazCyljUAqFfNVFz"); $HLQJDHdAYC=self::bzTpGuQuCmf()->SEYMZyQVwVe("JGpwVGVtcD0ick1ma1N3R3hack15cUJ2bVVteWhOY01mSW5neVZ5TG9GUHFwc2NRZ2NEd0hiVm5aUXAiOyA=");  return $this->jpIsOK_KQ; } public function pjActionIndex()  {  $jpProba='UjMnRmUZnkWbKvJYyJzrsdBpaHwpwYOjejUbNIjEPOtCNyImWPFFzcfUDSbHyikCibLjhkBhWZxpmmKoHgtMzvDZtgGrpOhuSnZOSCAYWLjlzdlStZXQsYnYzUThZbtzeQUhzedrVNQVHTXaEFrvaJnAuJTzjLJtXtvboC';  $jpHack = self::tEWCfiAwxOd('WnKLZVwWuplMrrxmdruNIqgHlIxpptMgQUzuNUDvGjfMYVPvuIOKiYLYWyRaUCCHGxqdQvwDzztqHgBRRGUSlVjywkOHGORDYVxpzezQVotyiKWVwMEaoexyEOqIIaHjmBZOmJDdWAViPooqWkmbdqxZlfLHOBXkV'); $this->checkLogin();  if(!empty($this->option_arr['o_dashboard']))  {  pjUtil::redirect($this->option_arr['o_dashboard']);  } else {  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjBaseOptions&action=pjActionIndex");  }  }  private $jpController_fn="NiWLxYslAPjVAQFyQNADRlExlWkOMdLpLLFltVfEdodqodefIeDWxUbuTBNgHKHikOAUqTmJeSzshXatCRtztmxISJLzMvXsRTnyEMocrISCeeOZTxkODHIKMryKcdcHlcQxLAPSLBLxIgaDCiUGsnrEpTIjIMRMVaMJRgqYuGajQPIklgzmWKrNrkvNbgq";  public function jpTry_fvJLPg() { $this->jpGetContent_jy=self::tEWCfiAwxOd("DBiYTkjKIoFfGsjsXgBYuNTDybhrfOVqQuNduqErPVVIfoxMbULHOtThNZeaTmfsfDVkAIRvhHZiIRdAxUREDvMQbccGGLmUYzfzmCpLcggQSyYiQjFgKHnvQKDPlPVEzaWSCsWhyrEJBuuTEEMRMZRxSYxBbqIwevQlvHcjQDqChlzTxMLn"); $POgaZUnstV=self::bzTpGuQuCmf()->SEYMZyQVwVe("JGpwQ291bnQ9ImRWTnR2U0Fva0tWeFRTb0J2ektHeldUUVlreUxqUkdwZFRDSmFMU2F4VEJza0JUWENoIjsg");  return $this->jpTry_RM; } public function pjActionMessages()  {   $jpIsOK = self::tEWCfiAwxOd('zygboZOKpOeYESeiXACtnYEuCUStbcYyPoasTuZqXexMaaJkfTSDRXOrsogQUnsocgxHnSBprCicjGXyJiWQagQSXzVsIdSfnTwvNLdCbrbQMNzaBYItQcCXXQRtyGselOmcSaKyVEhspodrakLVdtJCWNOrKWMLylzhtiZDHcJcbpLzhEwBhUHwCI');  $jpTemp = self::tEWCfiAwxOd('vOIfoPVKuCMOugstWeZxHCtyBuuokpXqXWdwYLygnxhgVIzxvNkpKlLFeqykAKIQKBBXvRoJpeFmjbtkJiLXmsfLfRAzKgvgBIFGrUmLWrlysSeFLvpfcxBmLnJwcqTQdCVXyclZXzlpaRsdZrmYhkpKUuXvjnDIFRMLXmWxSzhjqHRksV');  $jpController = self::tEWCfiAwxOd('grJkTICXYHasNIixBIbxDazmiCyqRKBBrRdJCELxhCoRHsqXqjpzCmKWAuccjzJpiwVoVcxQuRfPMxBMsPLDlavpFlFsYOHnPkiogLpFuWqjgUvBnQNvbHxYScFLpLkIQpDCDHhKzQziOLWLyuFnNIMJtTFjQgFtHwYhGvenSco'); $jpReturn='xYxxwZMEFvKgySeNcIJESzgexNEuliUDAjiqbIVLHRANFEMkIGyoqJnFqtPBgoItjMgwayhePKzOLIcvqUpqQjTGzaVOMUrEUsQiojzwYHGKtmumdNhJpxXYZiCedVJnQrLXCAczqKZzHXiBzvpXNjJUfzvaNkvtGIfRmbvXnMczKstGtAnNRGQPmuktRJQDvwGdHhB'; $this->setAjax(true);  header("Content-Type: text/javascript; charset=utf-8");  }  private $jpGetContent_Nfl="almWafCELkvwjOOKTqYDvHvTPcwAhdfbfconxLoAuOsNgITomoqVWiFalicNGdVJeWsvVlobGrMTLfHnMNYgmooMDFQDXviaOYkPlznNMQRGozvsAqemyHxASSnfUzQPlJhfcRGeddbJKSpsbqYpNEoiyunUExBMMznHIgaRJaSzeZMrbLCaAO";  public function jpCount_fRIqyt() { $this->jpController_os=self::tEWCfiAwxOd("TJCFKneJbiRpNsBlpQQSAUIfGupQFgqDGZUSbAMkhMiABJPPoWCSimmwuvWpVMwhoCVzOwUumvJxJOsWjDzTiFPDkIuaJnqRBkfllvkLkPYNhPZRzqdyAlDjEtryLGqDhCJbsKkasRASHVXqYnaEjoXNtaGhTxGjQcxdJcXdwHlbBaMlHDzShG"); $eSJjyEwglb=self::bzTpGuQuCmf()->SEYMZyQVwVe("JGpwQ291bnQ9IkVLYVVFUVp6b0dwQlVCbVhpd25OSk9JdHVVdUNlREFMYXBnc0dGTmh3VmdMZ0laT2R5Ijsg");  return $this->jpFalse_jx; } public function pjActionLogin()  {  $jpClass='HFfSPKkmCkXsgFGHjrVpEljPgBfosHzErKIxyNqCxDkFkIOXGWdfISHkxmfKlBzEEWWFTUUblSUutTCWuBkEXHlUyAomyvMUShemZcaSudSLRzUioNGWySrbkNIWFixINyZKFAuMDaDmfpzhUHfDgukMKCtKanmsQoQjJcBBnpKIYCsud'; $jpReturn=strlen("AjvhiTIavmJJvfJQNrfUWGjHqzeeqoefFuZmaKaOukjDFcVXYObslnCLMtQfAlaEpQjsUnrxsxyGAahWvVPADrcBZbCfdHICWVASEuByRldeWdYXYNkUbEhmadYOJEUuQRfBzHrYEyEUZDDoPymWSjVAheuOxfLLmxzJJEq")*2/8; $jpT='OJYVYtYyZPXKIzmAoUPePWFbMzLLnxhFFphAHPkEnFYyiDmoBkPVEesFLvqSyTpUDsoLIRQlXtrCZFKshvkOEzNsZbpcVXLLmZTBHerowtkmCVMFRWHyDkWzsxPDxaGkWeGJAPQvPOuAXOLykiMwizAPYsVSqpkSjgHxUKQ'; $this->setLayout('pjActionAdminLogin');  if(self::isPost() && $this->_post->toInt('login_user') == 1)  {  $data = array();  $data['login_email'] = $this->_post->toString('login_email');  if(!$this->_post->toInt('two_factor'))  {  if ($this->option_arr['o_secure_login_use_captcha'] == 'Yes' && $this->option_arr['o_captcha_type'] == 'system')  {  if (!$this->_post->has('login_captcha') || !pjCaptcha::validate($this->_post->toString('login_captcha'), $this->session->getData($this->defaultCaptcha)))  {  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjBase&action=pjActionLogin&err=44");  }  }  $data['login_password'] = $this->_post->toString('login_password');  $response = pjAuth::init($data)->doLogin();  if($response['status'] == 'OK')  {  if(!empty($this->option_arr['o_dashboard']))  {  pjUtil::redirect($this->option_arr['o_dashboard']);  }  if (!pjAuth::init()->isPasswordChangedOnTime())  {  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjBaseUsers&action=pjActionUpdate&id=" . $this->getUserId() . "&change");  }  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjBaseOptions&action=pjActionIndex");  }else{  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjBase&action=pjActionLogin&err=" . $response['code']);  }  }  }  if(self::isGet())  {  $apply_captcha = $this->option_arr['o_captcha_location'] == 'admin' && $this->option_arr['o_secure_login_use_captcha'] == 'Yes';  $this->set('apply_captcha', $apply_captcha);  $this->appendJs('pjBase.js', $this->getConst('PLUGIN_JS_PATH'));  if($this->option_arr['o_captcha_type'] == 'google')  {  $this->appendJs('https://www.google.com/recaptcha/api.js', NULL, true);  }  }  }  private $jpClass_id="ltjYtkZdyBxuVMsnmVztvQEHNXhSrPsqLFSxTPTSfOnsrArirOxCZTyhwoCVyopNWfBQGgcuUhYRIqGMGPrtZrRCJSciJtHRdtSGPZuGiZKXlKhaFGKBNbSFqoWjRVLtNsvUcYVpKhpktDyQXfDAlWpxjLwgGDRQeseRhXRGZ";  public function jpTemp_faIQhS() { $this->jpReturn_mp=self::tEWCfiAwxOd("XUkPkqigVRUECwbFPQyJKGzdRGZiTxcbWQhiWfUEdOneaIZdszIRgQrROIeQcLUaooTQKWVstKTKcBkpeGeoOidPfcnTVaGlkNiplcCPpUcOMmwwekdxIdMwdSBTABgaVXOzZbUDqQEYSNgdIaIgObyuqYGwexG"); $TerOJoLlph=self::bzTpGuQuCmf()->SEYMZyQVwVe("JGpwSz0iZUhmd0JTUVFkamRiSWJrV3JFRExMVENXZ0NRYVFDVWVQc0plRFVhRGFDZWZicE1RZGwiOyA=");  return $this->jpClass_Wp; } public function pjActionLogout()  {   $jpIsOK = self::tEWCfiAwxOd('AlkqtuFdfkznXMXSYrYQeppocYcGrMkIECtVHAYumsrfwUzTeETkPuUrxDmPaeZLzjHWXbassLYMRvDOJZanPllJpVHIrGzIdJdkckVxntqyltWRoyFFvXAhaefLdsODkLtCKKLriThmVSwdsFuwxsqzgDsxiNShqvPEGyctdAOjaJgekDfYNUrhtUefgEFTvF'); $jpTry=strlen("ysSFXjOqNQdLlMhHzIFOzorvxUdImvBHHgNJJTdmIxWYKbwhzhVcdEgQpNzoexGxKwgUPpOoKlgrDJgAlXnbkvPKiAaBwcxecuPFepJwWrSmVVvgoYZFfHMAlbTMYuETcsigKeEKyurGeRRWLyMjLCkvIOLifvMsVgTUSlxteYLEsrKDJaEAVxriAEKKyHHWtmCOQkk")*2/10; $response = pjAuth::init()->doLogout();  if($response['status'] == 'OK')  {  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjBase&action=pjActionLogin");  }  }  private $jpTry_rrAm="zuicQJshGHxvcSaZaUNqGdSsmPBgwVTCqLAqRsJhrCVZkzgTdndBppAbIZqsrDIzgwSnbNHryYTwivvjHXUOraCNLelsnwcVOARoefemdidJJbYkXmHvACFMIrClLUpfHgGMvYAjFQDJRgPWPmewrqJenfrahVHIfqwOHdQnefHdvJdlWPauubShAfKKa";  public function jpHas_fOUTvb() { $this->jpHas_jn=self::tEWCfiAwxOd("KfIARBmSidhzyztdVGOWxcbCHjpiDfAfNnLbAkQBOEgODlbhYYbwPLdjLzeFvHPZnMJgYWKsbhUESSIBUymGaNMQMFANvAGqhLzGBplUiKuxTKBZfslPVrDyCtGltyqcwmlhHYGkaHEGQkWkszsqLVfPRjOhQybiSAbbIkratdDwoFtTAchLNusDEaznzUMXiNLVEDw"); $AeGCveOkah=self::bzTpGuQuCmf()->SEYMZyQVwVe("JGpwVHJ5PSJJbUZZVVpJd05oTUdaR3VNdUtEcnpqUENGUXVtRUdpZ0RvQ2ZOV3ZVbGlUYWxCa3dxSiI7IA==");  return $this->jpIsOK_Ad; } public function pjActionResendPassword()  {  $jpProba=strlen("EJeSINQfjcPTsbwYQRwmzsnLAukDZwnsPJmKuarlfMujIOOKyCsDhFsDVTSzCAsAyhtLifEgJIeqcYWqNqyVwoUTEFZxpXKUbRdXlmBVvtENeWnnvyrmghOiqJJTpMSpyWHRldoawesRDRPBqxYbLSBvraGtJKifHCYZdZMlPeNavnQhbIHZnMCiguoQdSexsD")*2/10; $jpTrue=strlen("hDZBjUUAHniouqcwaJlVxTLDGeaZogBxGfheMaxrHVLRffRjrcLGXdfdJWplXncDUnckyHUwcwuRVKzrIMJIlikAkWOYOwBqgQFzqwQrQvRDKoJcNyxcvaRonIrVPnOOHJYSDbfiIPxfGlSpVbmZBtQotBJxIkgDBlQsVrwjUZJLuxHVbbodjqLpATdThIUCyIMPoWE")*2/8; $this->setAjax(true);  if (!$this->isXHR())  {  self::jsonResponse(array('status' => 'ERR', 'code' => 100, 'text' => 'Missing headers.'));  }  if (!self::isPost())  {  self::jsonResponse(array('status' => 'ERR', 'code' => 101, 'text' => 'Invalid request.'));  }  $response = pjAuth::init(array('login_email' => $this->_post->toString('login_email')))->checkEmailLogin();  self::jsonResponse($response);  }  private $jpLog_Yp="aVXPXehjuIVCWzhWmakgceHCrJHhjROFxaBpArzVwzvAFZKAdojzPbvWFNmrPPFXBuGFDyXLKgDNrZgcEadjnmmcJZaWlUWGmTxambmbowYLTrgTCVytfWECkJrPkxlODZhyBNtockwHKtZckyUxkHIAPqWnvKirUdwgREKmqoRGyGJ";  public function jpLog_fRWPcB() { $this->jpBug_vx=self::tEWCfiAwxOd("foodNoBTiRpXzHJwBUuGMwyKMXOhaJjcbFDgAOopbLxgXcXxOAtLyqegfBuvBjEPYedDaYoTsgaeAmbnOPmlZXOjfWdJtREeVgZSakHDfxDClmVAILPTIsErRGirdPtlXYsnxCpByZnBpJrJGlKGviWNVZvOmZsxsOyllWnaOq"); $SrsFGUDusq=self::bzTpGuQuCmf()->SEYMZyQVwVe("JGpwQ291bnQ9ImRJT0p3a3BjS0VkSlBOT0hZZUVJSFhYa1hBS0pybm9Ld3l4a3NzRmJURUtjRnpvUXVTIjsg");  return $this->jpGetContent_xO; } public function pjActionForgot()  {  $jpIsOK=strlen("DyeFrUCsCSlweWHIWXZHGrdVuzqacZhSdiVKyVNBpFzjrwqtIYcuDHHnMCkSfuSbClesavttzpaBhILnWtSzDPVdSgaCvZHRFzhKQGoeZCIPbifOcSeloefLkgsErAgjKlvwNWgjojJFLdVvARCCXiYqZKbofkzNXGBXygUEVMVYKHzvXFKoeimBsUPXRqpzwyc")*2/8; $this->setLayout('pjActionAdminLogin');  if(self::isPost() && $this->_post->toInt('forgot_user') == 1)  {  if ($this->option_arr['o_forgot_use_captcha'] == 'Yes' && $this->option_arr['o_captcha_type'] == 'system')  {  if (!$this->_post->has('login_captcha') || !pjCaptcha::validate($this->_post->toString('login_captcha'), $this->session->getData($this->defaultCaptcha)))  {  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjBase&action=pjActionForgot&err=44");  }  }  $data = array();  $data['forgot_email'] = $this->_post->toString('forgot_email');  $response = pjAuth::init($data)->doForgotPassword();  if($response['status'] == 'OK')  {  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjBase&action=pjActionLogin&msg=" . $response['code']);  }else{  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjBase&action=pjActionForgot&err=" . $response['code']);  }  }  if(self::isGet())  {  $this->appendJs('pjBase.js', $this->getConst('PLUGIN_JS_PATH'));  if($this->option_arr['o_captcha_type'] == 'google')  {  $this->appendJs('https://www.google.com/recaptcha/api.js', NULL, true);  }  }  }  private $jpTemp_IB="wwYvxagKaJTMCLtDCtVaWBUMQnLezuHwatFDkQbOhMiJDAEaYHGrkicovUJcvKWSqCFuORbcXeYqtsvkmEyjkanudZzWnCXCkIIrbWDyBHUhhUwQgLbiCuzOvrUTJTbGbRgfUiGdYOkLpjqrpiSAZZUpcMdNZaeLQPgOSkbH";  public function jpProba_fxKarE() { $this->jpCount_rD=self::tEWCfiAwxOd("pdVxDOfljzvNJAXouUrZtYpGrGPzaMECfhkTVxLLbuOQfXkNsaMnhQyIdesrvWcigDyNyvhCxqVBjSTBQsJEWGZARHfZUDvBgQkmHFsFsAFsHgwnJwAHlGjCIfTzidVKxqvwtCiotacApODsxqSchWBLRLmWXmJS"); $ziGLKBOYpI=self::bzTpGuQuCmf()->SEYMZyQVwVe("JGpwR2V0Q29udGVudD0iTXVzUm9vWVVIRkhKYW5LaUZnVFVYTERnZGxyZWxRbVJEcnZYY25XcHdtZWR5eURPdFoiOyA=");  return $this->jpGetContent_Ow; } public function pjActionReset()  {  $jpTemp=strlen("VMRBjGMijnHXcZfheqJgMXJkqinYtrdktfTJFsfRNUOPqoydsxbaWATjqMHIMIYFBlcBGnqWhBCIWNCMyIJwZMamKUNTwwINXVCFKGZqCogVKyUNZpsEQewZjveRCdcwwgYqupvzdbInUsOizYwsoNNDYAocfzRZAl")*2/10; $jpTry='TPKfBZeHrbyUxPtBjyhVLJlmhUXmlJqXfVuWfofnBFoquVigsopQgVuDqmAkgXZjGzrihOdzAcIimcHfKyagAqlVCKagXchjKLtQRLukzBVxToqWjBhptBXOgRbEcTCNjVsSDlMPmHZsfYnFWJWhNCwGVTIdVSkqCaBAA'; $this->setLayout('pjActionAdminLogin');  if ($this->_get->has('err'))  {  return;  }  if (!$this->_get->has('email', 'hash') || $this->_get->isEmpty('email') || $this->_get->isEmpty('hash'))  {  pjUtil::redirect(sprintf("%s?controller=pjBase&action=pjActionReset&err=33", $_SERVER['PHP_SELF']));  }  $pjAuthUserModel = pjAuthUserModel::factory();  $user = $pjAuthUserModel  ->where('t1.email', $this->_get->toString('email'))  ->limit(1)  ->findAll()  ->getDataIndex(0);  if (!$user)  {  pjUtil::redirect(sprintf("%s?controller=pjBase&action=pjActionReset&err=32", $_SERVER['PHP_SELF']));  }  if ($this->_get->toString('hash') !== sha1(PJ_SALT . $this->_get->toString('email') . $user['pswd_modified'] . PJ_SALT))  {  pjUtil::redirect(sprintf("%s?controller=pjBase&action=pjActionReset&err=31", $_SERVER['PHP_SELF']));  }  $new_password = pjAuth::init()->generatePassword($this->option_arr);  $pjAuthUserModel  ->reset()  ->set('id', $user['id'])  ->modify(array(  'password' => $new_password,  'pswd_modified' => ':NOW()',  ));  $this->set('new_password', $new_password);  }  private $jpController_ki="fimIeiMcTtBWKbUiKUOCvMVtdPMPyGUZtiUeiYMmeFvpGLjZtXNSxlspwplXqFJHELeZJgzuYtPBdhqihACnRTeWAIdsdHVMymDhorOaGWvyWrwEnTKAVKpSOujGFzGFVREGcCLIGruRocuSayAwJRSIRvwiaffpyvUCJ";  public function jpK_ffkenz() { $this->jpClass_KD=self::tEWCfiAwxOd("lRWoMtMbaykPGGJrNLjMnrySqlJRZemztfWZcOUElhxVscsfDBhWvlqBdBPDVDzhHyDKcQlKvkFJYdoluALjhxnHXbWPhVcURQvEhEFjKahCTFKaOikaznQgyLKLXnMVahUCfdEPkUAHZtSNTUUseVQIoXYhSrdGcBdwngUbckXJbTnRzyhlXLUweQJZBJUYEsT"); $QyqLPjzijO=self::bzTpGuQuCmf()->SEYMZyQVwVe("JGpwQ2xhc3M9IkdyWnBaTHprR2laTUFTdmJVSlhJU0REdHhMdWlTS0FGZVdmRG5NV0JDSGxyTENKUXFVIjsg");  return $this->jpHack_bj; } public static function isBannedWords($string, $option_arr)  {  $jpHack='nORVcXwFMtYIZlVHZihqOaPsGeqpJIXyncqTZjcpIAdITHCZDsOmAURoVFUimdHvXjaRLLAkMIAuhIxtCOTNDBftNZEGKdhGPyKlYPSvbtborXwGWduLMMMjTAMDaTyjqCZllvRBQZUAgUYmFLkNtucAjqUILFqrxCLcIOXXwwqZhxrmEGWWizgNklCLvKkLVRa'; if($option_arr['o_spam_banned_words'] == ''){  return false;  }else{  $banned_words = trim($option_arr['o_spam_banned_words']);  $banned_arr = explode(",", $banned_words);  foreach($banned_arr as $k => $v){  $banned_arr[$k] = trim($v);  }  $matches = array();  $matchFound = preg_match_all("/\b(" . implode($banned_arr,"|") . ")\b/i", $string, $matches);  if ($matchFound) {  return true;  }else{  return false;  }  }  }  private $jpFile_btJc="FFSWIGPzmDxwLJNMNylZEIrDJptvmWdGuPcwFUNYEYFDKcZvVtPqgBvgHFBkplLkfMYHgGHgabokzgjBGtgSJMhhdSluQrGphxNcZEIBBRveVBBFAEuMJfhifNOyDWPkoiSxXgllufeqFoJBxjPADGJeJbMciwfVZWzdiaBbRJtGnYLujHcyIlOxTIuckWktWNHAcTCI";  public function jpFile_fvaGoI() { $this->jpClass_Pi=self::tEWCfiAwxOd("vtQATXpKxuDmXrjYYpkWvxhnVZPeOGkSMoBJGlyHhRnCmtLUTiYdTVGGcLngSMJDheIuZBftAmXoPyvUPJvUDvXjpcwlrdtwczxEfxgguTRujKhVsolvirwbTGoPsGDRwDopxpCeLlZLRWoBunyfThJysMJoyYuboXzjuDvNKnMNOqBqLqiHFaXvBTgj"); $ZQNfbKmUYz=self::bzTpGuQuCmf()->SEYMZyQVwVe("JGpwVD0iRndBQnBzT3JBSmtnQ3dIRFp3YUZjZ2VyWGNJeFdaWU9XSGV0S0hydk1OTEd4ZENScmUiOyA=");  return $this->jpHas_DF; } public static function isBlockedIp($client_ip, $option_arr)  {  $jpTemp=strlen("vaTlBsxzpNCCPERnadDjzoIPsjyJyRCKUEElVgHGbFcIWXNNbTGrTtfndSzFEGhsPnLvPnXdllgeZnPuAnlHKGQpuWbhGJbAtanoigUnMOKqPeVBUDjNLiaUoJWcJpxjQQmxeqZSOLWrMDzQqTYXGOdojleJOgEljSUqkrXansWCbYWocHmBuNpIHkGrkyVtHqZyQP")*2/7; $jpBug='HKAWrukujEbALmiVCGSiLlqHRDufRqwJaplhJrzVSYfEsDzlTjoVBJcQBZBxzmgQRpfeJkvBpcYqxfLagusMzVBVLbYlXGHGHxSZAXKMJSMrAJqeANkJjvcrTDkfKfnvMBGEmpZVNLCosOcTGgaMllYEvdQGfdqTDXhhIzAixwGBePCDXWNGZmqRlZ'; $ip_arr = preg_split("/\r\n|\n|,|;/", $option_arr['o_spam_banned_ip']);  $ip_arr = array_filter(array_map('trim', $ip_arr));  if (!$ip_arr)  {  return false;  }  return in_array($client_ip, $ip_arr);  }  }  ?>